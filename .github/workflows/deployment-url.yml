name: Deployment URL
on:
  pull_request:
    branches: [main]
    types: [opened]
jobs:
  example_comment_pr:
    runs-on: ubuntu-latest
    name: Add deployment URL
    steps:
      - name: 'Comment PR'
        uses: actions/github-script@0.3.0
        # Donâ€™t run the action on forks
        if: github.repository == 'cesko-digital/movapp'
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const { issue: { number: issue_number }, repo: { owner, repo }  } = context;
            const { GITHUB_HEAD_REF } = process.env;
            const escapedBranchName = GITHUB_HEAD_REF.replace("/", "-");
            const deploymentUrl = `https://movapp-git-${escapedBranchName}-ceskodigital.vercel.app`;
            github.issues.createComment({ issue_number, owner, repo, body: `ðŸ“Œ PR se bude nasazovat sem: ${deploymentUrl}.` });
